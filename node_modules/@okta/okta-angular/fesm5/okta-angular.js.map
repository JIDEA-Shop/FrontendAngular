{"version":3,"file":"okta-angular.js","sources":["../package/src/okta/models/okta.config.ts","../package/src/okta/components/callback.component.ts","../package/src/okta/okta.guard.ts","../package/src/okta/services/auth-state.service.ts","../package/src/okta/has-any-group.directive.ts","../package/src/okta/packageInfo.ts","../package/src/okta/okta.module.ts"],"sourcesContent":["/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { InjectionToken, Injector } from '@angular/core';\nimport { OktaAuth } from '@okta/okta-auth-js';\n\nexport type AuthRequiredFunction = (oktaAuth: OktaAuth, injector: Injector) => void;\n\nexport interface TestingObject {\n  disableHttpsCheck: boolean;\n}\n\nexport interface OktaConfig {\n  oktaAuth: OktaAuth;\n  onAuthRequired?: AuthRequiredFunction;\n  onAuthResume?: AuthRequiredFunction;\n  testing?: TestingObject;\n}\n\nexport const OKTA_CONFIG = new InjectionToken<OktaConfig>('okta.config.angular');\nexport const OKTA_AUTH = new InjectionToken<OktaAuth>('okta.auth');\n","/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { Component, OnInit, Optional, Injector, Inject } from '@angular/core';\nimport { OktaAuth } from '@okta/okta-auth-js';\nimport { OKTA_CONFIG, OktaConfig, OKTA_AUTH } from '../models/okta.config';\n\n@Component({\n  template: `<div>{{error}}</div>`\n})\nexport class OktaCallbackComponent implements OnInit {\n  error: string;\n\n  constructor(\n    @Inject(OKTA_CONFIG) private config: OktaConfig,\n    @Inject(OKTA_AUTH) private oktaAuth: OktaAuth,\n    @Optional() private injector?: Injector\n  ) {}\n\n  async ngOnInit(): Promise<void> {\n    try {\n      // Parse code or tokens from the URL, store tokens in the TokenManager, and redirect back to the originalUri\n      await this.oktaAuth.handleLoginRedirect();\n    } catch (e) {\n      // Callback from social IDP. Show custom login page to continue.\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore Supports auth-js v5 & v6\n      const isInteractionRequiredError = this.oktaAuth.isInteractionRequiredError || this.oktaAuth.idx.isInteractionRequiredError;\n      if (isInteractionRequiredError(e) && this.injector) {\n        const { onAuthResume, onAuthRequired } = this.config;\n        const callbackFn = onAuthResume || onAuthRequired;\n        if (callbackFn) {\n          callbackFn(this.oktaAuth, this.injector);\n          return;\n        }\n      }\n      this.error = e.toString();\n    }\n  }\n}\n","/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { Injectable, Injector, Inject } from '@angular/core';\nimport {\n  CanActivate,\n  CanActivateChild,\n  ActivatedRouteSnapshot,\n  RouterStateSnapshot,\n  Router,\n  NavigationStart, \n  Event,\n  CanLoad,\n  Route,\n  UrlSegment\n} from '@angular/router';\nimport { filter } from 'rxjs/operators';\n\nimport { OktaAuth, AuthState } from '@okta/okta-auth-js';\n\nimport { AuthRequiredFunction, OktaConfig, OKTA_CONFIG, OKTA_AUTH } from './models/okta.config';\n\n@Injectable()\nexport class OktaAuthGuard implements CanActivate, CanActivateChild, CanLoad {\n  private state: RouterStateSnapshot;\n  private onAuthRequired?: AuthRequiredFunction;\n\n\n  constructor(\n    @Inject(OKTA_CONFIG) private config: OktaConfig, \n    @Inject(OKTA_AUTH) private oktaAuth: OktaAuth, \n    private injector: Injector\n  ) { \n    this.onAuthRequired = this.config.onAuthRequired;\n\n    // Unsubscribe updateAuthStateListener when route change\n    const router = injector.get(Router);\n    router.events.pipe(\n      filter((e: Event) => e instanceof NavigationStart && this.state && this.state.url !== e.url)\n    ).subscribe(() => {\n      this.oktaAuth.authStateManager.unsubscribe(this.updateAuthStateListener);\n    });\n  }\n\n  async canLoad(route: Route, segments: UrlSegment[]): Promise<boolean> {\n    this.onAuthRequired = route.data && route.data.onAuthRequired || this.onAuthRequired;\n\n    const isAuthenticated = await this.oktaAuth.isAuthenticated();\n    if (isAuthenticated) {\n      return true;\n    }\n\n    const originalUri = segments[0].path;\n    await this.handleLogin(originalUri);\n\n    return false;\n  }\n\n  /**\n   * Gateway for protected route. Returns true if there is a valid accessToken,\n   * otherwise it will cache the route and start the login flow.\n   * @param route\n   * @param state\n   */\n  async canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Promise<boolean> {\n    // Track states for current route\n    this.state = state;\n    this.onAuthRequired = route.data && route.data.onAuthRequired || this.onAuthRequired;\n\n    // Protect the route after accessing\n    this.oktaAuth.authStateManager.subscribe(this.updateAuthStateListener);\n    const isAuthenticated = await this.oktaAuth.isAuthenticated();\n    if (isAuthenticated) {\n      return true;\n    }\n\n    await this.handleLogin(state.url);\n\n    return false;\n  }\n\n  async canActivateChild(\n    route: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot\n  ): Promise<boolean> {\n    return this.canActivate(route, state);\n  }\n\n  private async handleLogin(originalUri: string): Promise<void> {\n    // Store the current path\n    this.oktaAuth.setOriginalUri(originalUri);\n\n    if (this.onAuthRequired) {\n      this.onAuthRequired(this.oktaAuth, this.injector);\n    } else {\n      this.oktaAuth.signInWithRedirect();\n    }\n  }\n\n  private updateAuthStateListener = (authState: AuthState) => {\n    if (!authState.isAuthenticated) {\n      this.handleLogin(this.state.url);\n    }\n  };\n\n}\n","import { Injectable, OnDestroy, Inject } from '@angular/core';\nimport { AuthState, OktaAuth, UserClaims } from '@okta/okta-auth-js';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { mergeMap } from 'rxjs/operators';\nimport { OKTA_AUTH } from '../models/okta.config';\n\nconst defaultAuthState = {\n  isAuthenticated: false\n};\n\nexport type Groups = string | string[] | { [key: string]: string[] };\n\n@Injectable()\nexport class OktaAuthStateService implements OnDestroy {\n  private _authState: BehaviorSubject<AuthState> = new BehaviorSubject<AuthState>(defaultAuthState);\n  \n  // only expose readonly property\n  public readonly authState$: Observable<AuthState> = this._authState.asObservable();\n\n  constructor(@Inject(OKTA_AUTH) private oktaAuth: OktaAuth) {\n    this.updateAuthState = this.updateAuthState.bind(this);\n\n    // set initial authState\n    const initialAuthState = this.oktaAuth.authStateManager.getAuthState() || defaultAuthState;\n    this._authState.next(initialAuthState);\n\n    // subscribe to future changes\n    this.oktaAuth.authStateManager.subscribe(this.updateAuthState);\n  }\n\n  ngOnDestroy(): void {\n    this.oktaAuth.authStateManager.unsubscribe(this.updateAuthState);\n  }\n\n  // Observes as true when any group input can match groups from user claims \n  hasAnyGroups(groups: Groups): Observable<boolean> {\n    return this.authState$.pipe(\n      mergeMap(async ({ isAuthenticated, idToken }) => {\n        // return false when not authenticated or openid is not in scopes\n        if (!isAuthenticated || !idToken) {\n          return false;\n        }\n\n        // transform inputs to consistent object format\n        if (typeof groups === 'string') {\n          groups = { groups: [groups] };\n        }\n        if (Array.isArray(groups)) {\n          groups = { groups };\n        }\n\n        const key = Object.keys(groups)[0] as keyof UserClaims;\n        const value = groups[key];\n\n        // groups or custom claims is available in idToken\n        if (idToken.claims[key]) {\n          return value.some((authority: string) => (idToken.claims[key] as unknown as string[]).includes(authority));\n        }\n\n        // try /userinfo endpoint when thin idToken (no groups claim) is returned\n        // https://developer.okta.com/docs/concepts/api-access-management/#tokens-and-scopes\n        const userInfo = await this.oktaAuth.getUser();\n        if (!userInfo[key]) {\n          return false;\n        }\n        return value.some((authority: string) => (userInfo[key] as unknown as string[]).includes(authority));\n      })\n    );\n  }\n\n  private updateAuthState(authState: AuthState): void {\n    this._authState.next(authState);\n  }\n}\n","import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { OktaAuthStateService, Groups } from './services/auth-state.service';\n\n@Directive({ selector: '[oktaHasAnyGroup]'})\nexport class OktaHasAnyGroupDirective {\n  private previousIsAuthorized: boolean;\n\n  constructor(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    private templateRef: TemplateRef<any>,\n    private viewContainer: ViewContainerRef,\n    private authStateService: OktaAuthStateService\n  ) { }\n\n  @Input() set oktaHasAnyGroup(groups: Groups) {\n    this.authStateService.hasAnyGroups(groups)\n      .subscribe(isAuthorized => {\n        // don't update UI if no state change\n        if (isAuthorized === this.previousIsAuthorized) {\n          return;\n        }\n        this.previousIsAuthorized = isAuthorized;\n        this.viewContainer.clear();\n        if (isAuthorized) {\n          this.viewContainer.createEmbeddedView(this.templateRef);\n        }\n      });\n  }\n}\n","export default {\n  'name': '@okta/okta-angular',\n  'version': '5.2.0',\n  'authJSMinSupportedVersion': '5.3.1'\n};\n","/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { NgModule, Inject, Optional, VERSION } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Location } from '@angular/common';\nimport { OktaCallbackComponent } from './components/callback.component';\nimport { OktaAuthGuard } from './okta.guard';\nimport { OktaAuthStateService } from './services/auth-state.service';\nimport { OktaHasAnyGroupDirective } from './has-any-group.directive';\nimport { OktaConfig, OKTA_CONFIG, OKTA_AUTH } from './models/okta.config';\nimport { AuthSdkError, OktaAuth, toRelativeUrl } from '@okta/okta-auth-js';\nimport { compare } from 'compare-versions';\nimport packageInfo from './packageInfo';\n\nexport function oktaAuthFactory(config: OktaConfig): OktaAuth {\n  return config.oktaAuth;\n}\n\n@NgModule({\n  declarations: [\n    OktaCallbackComponent,\n    OktaHasAnyGroupDirective,\n  ],\n  exports: [\n    OktaCallbackComponent,\n    OktaHasAnyGroupDirective,\n  ],\n  providers: [\n    OktaAuthGuard,\n    OktaAuthStateService,\n    {\n      provide: OKTA_AUTH,\n      useFactory: oktaAuthFactory,\n      deps: [ OKTA_CONFIG ]\n    },\n  ]\n})\nexport class OktaAuthModule {\n  constructor(\n    @Inject(OKTA_CONFIG) config: OktaConfig, \n    @Optional() location?: Location, \n    @Optional() router?: Router\n  ) {\n    const { oktaAuth } = config;\n\n    const isAuthJsSupported = oktaAuth._oktaUserAgent && compare(oktaAuth._oktaUserAgent.getVersion(), packageInfo.authJSMinSupportedVersion, '>=');\n    if (!isAuthJsSupported) {\n      throw new AuthSdkError(`Passed in oktaAuth is not compatible with the SDK, minimum supported okta-auth-js version is ${packageInfo.authJSMinSupportedVersion}.`);\n    }\n\n    // Add Okta UA\n    oktaAuth._oktaUserAgent.addEnvironment(`${packageInfo.name}/${packageInfo.version}`);\n    oktaAuth._oktaUserAgent.addEnvironment(`Angular/${VERSION.full}`);\n\n    // Provide a default implementation of `restoreOriginalUri`\n    if (!oktaAuth.options.restoreOriginalUri && router && location) {\n      oktaAuth.options.restoreOriginalUri = async (_, originalUri: string | undefined) => {\n        const baseUrl = window.location.origin + location.prepareExternalUrl('');\n        const routePath = toRelativeUrl(originalUri || '/', baseUrl);\n        router.navigateByUrl(routePath);\n      };\n    }\n\n    // Start services\n    oktaAuth.start();\n  }\n\n}\n"],"names":["tslib_1.__param","tslib_1.__decorate"],"mappings":"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"}